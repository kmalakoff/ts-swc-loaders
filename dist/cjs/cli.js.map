{"version":3,"sources":["cli.cjs"],"sourcesContent":["const exit = require('exit');\nconst path = require('path');\nconst spawn = require('cross-spawn-cb');\nconst pathKey = require('env-path-key');\nconst prepend = require('path-string-prepend');\nconst spawnParams = require('./index.mjs').spawnParams;\nconst which = require('which');\n\nconst major = +process.versions.node.split('.')[0];\nconst type = major < 12 ? 'commonjs' : 'module';\n\nmodule.exports = function cli(args, options, cb) {\n  options = options || {};\n  const cwd = options.cwd || process.cwd();\n  const env = { ...process.env };\n  const PATH_KEY = pathKey();\n  env[PATH_KEY] = prepend(env[PATH_KEY] || '', path.resolve(__dirname, '..', '..', '..', '..', 'node_modules', '.bin'));\n  env[PATH_KEY] = prepend(env[PATH_KEY] || '', path.resolve(process.cwd(), 'node_modules', '.bin'));\n  const params = spawnParams(type, { stdio: 'inherit', cwd, env, ...options });\n  // biome-ignore lint/performance/noDelete: <explanation>\n  if (options.encoding) delete params.options.stdio;\n\n  function callback(err, res) {\n    if (cb) return cb(err, res);\n    if (err && err.message.indexOf('ExperimentalWarning') < 0) {\n      console.log(err.message);\n      return exit(err.code || -1);\n    }\n    exit(0);\n  }\n\n  // look up the full path\n  which(args[0], { path: env[PATH_KEY] }, (_err, cmd) => {\n    // not found, use the original\n    if (!cmd) cmd = args[0];\n\n    // spawn on windows\n    const cmdExt = path.extname(cmd);\n    if (path.extname(args[0]) !== cmdExt) return spawn(cmd, params.args.concat(args.slice(1)), params.options, callback);\n\n    // relative, use the original\n    if (args[0][0] === '.') cmd = args[0];\n\n    // node <= 0.12 didn't take the --require option\n    if (major < 12) return spawn(cmd, params.args.concat(args.slice(1)), params.options, callback);\n\n    // send to node\n    spawn(process.execPath, params.args.concat([cmd]).concat(args.slice(1)), params.options, callback);\n  });\n};\n"],"names":["exit","require","path","spawn","pathKey","prepend","spawnParams","which","major","process","versions","node","split","type","module","exports","cli","args","options","cb","cwd","env","PATH_KEY","resolve","__dirname","params","stdio","encoding","callback","err","res","message","indexOf","console","log","code","_err","cmd","cmdExt","extname","concat","slice","execPath"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAMA,OAAOC,QAAQ;AACrB,IAAMC,OAAOD,QAAQ;AACrB,IAAME,QAAQF,QAAQ;AACtB,IAAMG,UAAUH,QAAQ;AACxB,IAAMI,UAAUJ,QAAQ;AACxB,IAAMK,cAAcL,QAAQ,eAAeK,WAAW;AACtD,IAAMC,QAAQN,QAAQ;AAEtB,IAAMO,QAAQ,CAACC,QAAQC,QAAQ,CAACC,IAAI,CAACC,KAAK,CAAC,IAAI,CAAC,EAAE;AAClD,IAAMC,OAAOL,QAAQ,KAAK,aAAa;AAEvCM,OAAOC,OAAO,GAAG,SAASC,IAAIC,IAAI,EAAEC,OAAO,EAAEC,EAAE;IAC7CD,UAAUA,WAAW,CAAC;IACtB,IAAME,MAAMF,QAAQE,GAAG,IAAIX,QAAQW,GAAG;IACtC,IAAMC,MAAM,mBAAKZ,QAAQY,GAAG;IAC5B,IAAMC,WAAWlB;IACjBiB,GAAG,CAACC,SAAS,GAAGjB,QAAQgB,GAAG,CAACC,SAAS,IAAI,IAAIpB,KAAKqB,OAAO,CAACC,WAAW,MAAM,MAAM,MAAM,MAAM,gBAAgB;IAC7GH,GAAG,CAACC,SAAS,GAAGjB,QAAQgB,GAAG,CAACC,SAAS,IAAI,IAAIpB,KAAKqB,OAAO,CAACd,QAAQW,GAAG,IAAI,gBAAgB;IACzF,IAAMK,SAASnB,YAAYO,MAAM;QAAEa,OAAO;QAAWN,KAAAA;QAAKC,KAAAA;OAAQH;IAClE,wDAAwD;IACxD,IAAIA,QAAQS,QAAQ,EAAE,OAAOF,OAAOP,OAAO,CAACQ,KAAK;IAEjD,SAASE,SAASC,GAAG,EAAEC,GAAG;QACxB,IAAIX,IAAI,OAAOA,GAAGU,KAAKC;QACvB,IAAID,OAAOA,IAAIE,OAAO,CAACC,OAAO,CAAC,yBAAyB,GAAG;YACzDC,QAAQC,GAAG,CAACL,IAAIE,OAAO;YACvB,OAAO/B,KAAK6B,IAAIM,IAAI,IAAI,CAAC;QAC3B;QACAnC,KAAK;IACP;IAEA,wBAAwB;IACxBO,MAAMU,IAAI,CAAC,EAAE,EAAE;QAAEf,MAAMmB,GAAG,CAACC,SAAS;IAAC,GAAG,SAACc,MAAMC;QAC7C,8BAA8B;QAC9B,IAAI,CAACA,KAAKA,MAAMpB,IAAI,CAAC,EAAE;QAEvB,mBAAmB;QACnB,IAAMqB,SAASpC,KAAKqC,OAAO,CAACF;QAC5B,IAAInC,KAAKqC,OAAO,CAACtB,IAAI,CAAC,EAAE,MAAMqB,QAAQ,OAAOnC,MAAMkC,KAAKZ,OAAOR,IAAI,CAACuB,MAAM,CAACvB,KAAKwB,KAAK,CAAC,KAAKhB,OAAOP,OAAO,EAAEU;QAE3G,6BAA6B;QAC7B,IAAIX,IAAI,CAAC,EAAE,CAAC,EAAE,KAAK,KAAKoB,MAAMpB,IAAI,CAAC,EAAE;QAErC,gDAAgD;QAChD,IAAIT,QAAQ,IAAI,OAAOL,MAAMkC,KAAKZ,OAAOR,IAAI,CAACuB,MAAM,CAACvB,KAAKwB,KAAK,CAAC,KAAKhB,OAAOP,OAAO,EAAEU;QAErF,eAAe;QACfzB,MAAMM,QAAQiC,QAAQ,EAAEjB,OAAOR,IAAI,CAACuB,MAAM,CAAC;YAACH;SAAI,EAAEG,MAAM,CAACvB,KAAKwB,KAAK,CAAC,KAAKhB,OAAOP,OAAO,EAAEU;IAC3F;AACF"}