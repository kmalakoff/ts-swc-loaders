{"version":3,"sources":["cli.cjs"],"sourcesContent":["const exit = require('exit');\nconst path = require('path');\nconst spawn = require('cross-spawn-cb');\nconst pathKey = require('env-path-key');\nconst prepend = require('path-string-prepend');\nconst once = require('call-once-fn');\nconst spawnParams = require('./index.mjs').spawnParams;\n\nconst major = +process.versions.node.split('.')[0];\nconst type = major < 12 ? 'commonjs' : 'module';\n\nmodule.exports = function cli(args, options) {\n  const cwd = process.cwd();\n  const env = { ...process.env };\n  const PATH_KEY = pathKey();\n  env[PATH_KEY] = prepend(env[PATH_KEY] || '', path.resolve(__dirname, '..', '..', '..', '..', 'node_modules', '.bin'));\n  env[PATH_KEY] = prepend(env[PATH_KEY] || '', path.resolve(process.cwd(), 'node_modules', '.bin'));\n  const params = spawnParams(type, { stdio: 'inherit', cwd, env, ...(options || {}) });\n\n  const callback = once((err) => {\n    if (err) {\n      console.log(err.message);\n      return exit(err.code || -1);\n    }\n    exit(0);\n  });\n\n  if (params.options.NODE_OPTIONS || params.args[0] === '--require') {\n    spawn(args[0], params.args.concat(args.slice(1)), params.options, callback);\n  } else {\n    require('which')(args[0], { path: env[PATH_KEY] })\n      .then((cmd) => {\n        spawn('node', params.args.concat([cmd]).concat(args.slice(1)), params.options, callback);\n      })\n      .catch(callback);\n  }\n};\n"],"names":["exit","require","path","spawn","pathKey","prepend","once","spawnParams","major","process","versions","node","split","type","module","exports","cli","args","options","cwd","env","PATH_KEY","resolve","__dirname","params","stdio","callback","err","console","log","message","code","NODE_OPTIONS","concat","slice","then","cmd","catch"],"mappings":"AAAA,MAAMA,OAAOC,QAAQ;AACrB,MAAMC,OAAOD,QAAQ;AACrB,MAAME,QAAQF,QAAQ;AACtB,MAAMG,UAAUH,QAAQ;AACxB,MAAMI,UAAUJ,QAAQ;AACxB,MAAMK,OAAOL,QAAQ;AACrB,MAAMM,cAAcN,QAAQ,eAAeM,WAAW;AAEtD,MAAMC,QAAQ,CAACC,QAAQC,QAAQ,CAACC,IAAI,CAACC,KAAK,CAAC,IAAI,CAAC,EAAE;AAClD,MAAMC,OAAOL,QAAQ,KAAK,aAAa;AAEvCM,OAAOC,OAAO,GAAG,SAASC,IAAIC,IAAI,EAAEC,OAAO;IACzC,MAAMC,MAAMV,QAAQU,GAAG;IACvB,MAAMC,MAAM;QAAE,GAAGX,QAAQW,GAAG;IAAC;IAC7B,MAAMC,WAAWjB;IACjBgB,GAAG,CAACC,SAAS,GAAGhB,QAAQe,GAAG,CAACC,SAAS,IAAI,IAAInB,KAAKoB,OAAO,CAACC,WAAW,MAAM,MAAM,MAAM,MAAM,gBAAgB;IAC7GH,GAAG,CAACC,SAAS,GAAGhB,QAAQe,GAAG,CAACC,SAAS,IAAI,IAAInB,KAAKoB,OAAO,CAACb,QAAQU,GAAG,IAAI,gBAAgB;IACzF,MAAMK,SAASjB,YAAYM,MAAM;QAAEY,OAAO;QAAWN;QAAKC;QAAK,GAAIF,WAAW,CAAC,CAAC;IAAE;IAElF,MAAMQ,WAAWpB,KAAK,CAACqB;QACrB,IAAIA,KAAK;YACPC,QAAQC,GAAG,CAACF,IAAIG,OAAO;YACvB,OAAO9B,KAAK2B,IAAII,IAAI,IAAI,CAAC;QAC3B;QACA/B,KAAK;IACP;IAEA,IAAIwB,OAAON,OAAO,CAACc,YAAY,IAAIR,OAAOP,IAAI,CAAC,EAAE,KAAK,aAAa;QACjEd,MAAMc,IAAI,CAAC,EAAE,EAAEO,OAAOP,IAAI,CAACgB,MAAM,CAAChB,KAAKiB,KAAK,CAAC,KAAKV,OAAON,OAAO,EAAEQ;IACpE,OAAO;QACLzB,QAAQ,SAASgB,IAAI,CAAC,EAAE,EAAE;YAAEf,MAAMkB,GAAG,CAACC,SAAS;QAAC,GAC7Cc,IAAI,CAAC,CAACC;YACLjC,MAAM,QAAQqB,OAAOP,IAAI,CAACgB,MAAM,CAAC;gBAACG;aAAI,EAAEH,MAAM,CAAChB,KAAKiB,KAAK,CAAC,KAAKV,OAAON,OAAO,EAAEQ;QACjF,GACCW,KAAK,CAACX;IACX;AACF"}